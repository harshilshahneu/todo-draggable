<!DOCTYPE html>
<html lang="en">
<head>
    <title>Document</title>
    <link rel="stylesheet" href="dist/css/styles.css">
</head>
<body>
    <div class="container">
        <div class="user-profile">
            <div class="user-profile__info">
                <h1 class="user-profile__name">Hello Jane Doe</h1>
                <div class="user-profile__tasks">
                 
                </div>
            </div>
            <div class="user-profile__image">
                <img src="img/user_profile.png" alt="user">
            </div>
        </div>
        <ul class="task-list">
            <li id="test">
                <div class="task-completion">
                    <img src="./img/checked.png">
                </div>
                <div class="task">
                    <div class="task-title">
                        <div>Task 1</div>
                        <button id="add">+</button>
                    </div>
                    <div class="task-details">
                        <div class="task-header">Complete Assignment 1 of AED</div>
                        <div class="task-description">It is very important assignment</div>
                        <div class="task-due-date">2019-10-10</div>
                        <div class="task-due-time">12:00 AM</div>
                    </div>
                </div>
            </li>
        </ul>
        <div class="add-task">
            <button id="add-button" onclick="openAddTaskForm()">+</button>
        </div>
    </div>
    <div class="dialog">
        <div class="close-button">
            <button id="close-dialog" onclick="closeDialog()">x</button> 
        </div>
        <form class="form">
            <h3>
                Please Add a new task
            </h3>
            <div class="form__group">
                <label for="title">Title</label>
                <input type="title" id="title" name="title">
            </div>
            <div class="form__group">
                <label for="description">Description</label>
                <input type="text" id="description" name="description">
            </div>
            <div class="form__group">
                <label for="due-date">Due Date</label>
                <input type="date" id="due-date" name="due-date">
            </div>
            <div class="form__group">
                <label for="due-time">Due Date</label>
                <input type="time" id="due-time" name="due-time">
            </div>
        </form>
    </div>
    <script src="js/script.js"></script>
    <script>
        const taskDetails = document.querySelector('#test>.task');
        taskDetails.addEventListener('mousedown', event => {

            const startPoint = event.clientX;
            let completedFlag = 0;

            document.addEventListener('mousemove', mouseMoveHandler);
            document.addEventListener('mouseup', mouseUpHandler);

            function mouseMoveHandler(e){
                let currentPoint = e.clientX;
                diff = startPoint - currentPoint;
             
                if(diff <= 0 && diff >= -document.querySelector('#test>.task-completion').offsetWidth) {
                    taskDetails.style.transform = `translateX(${-diff}px)`;
                    if(diff ===  -document.querySelector('#test>.task-completion').offsetWidth)
                        completedFlag = 1;
                }
               
            }
            function mouseUpHandler(e){
              
                if(completedFlag) {
                  
                    const node = document.querySelector('#test');
                    node.style.opacity = 0;
                  
                    setTimeout(() => {
                        document.querySelector('.task-list').appendChild(node);
                        setTimeout(() => {
                            node.style.opacity = 1;
                        }, 10);
                    }, 300);
                   
                }
                taskDetails.style.transform = `translateX(0px)`;
                document.removeEventListener('mouseup', mouseUpHandler);
                document.removeEventListener('mousemove', mouseMoveHandler);
            }
        })
        document.querySelector('#add').addEventListener('click', () => {
            let taskDetails = document.querySelector('#test>.task>.task-details') ;
            if(taskDetails.style.display == 'block') {
                taskDetails.style.display = 'none';
            } else {
                taskDetails.style.display = 'block';
            }
        })
    </script>
</body>
</html>